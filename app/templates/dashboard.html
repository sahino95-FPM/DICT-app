{% extends "layouts/base.html" %}

{% block title %}Dashboard - FPMsigm | Inspections{% endblock %}

{% block content %}
<div class="dashboard">
    <h2 class="page-title">Tableau de bord</h2>

    <!-- Cartes statistiques -->
    <div class="cards-grid">
        <div class="card card-primary">
            <div class="card-header">
                <h3 class="card-title">üìã Nombre de PEC</h3>
            </div>
            <div class="card-body">
                <p class="card-value">{{ stats.pec_today|default(0) }}</p>
                <p class="card-label">PEC ayant d√©but√© leur ex√©cution aujourd'hui</p>
            </div>
        </div>

        <div class="card card-success">
            <div class="card-header">
                <h3 class="card-title">üîç Mod√®les</h3>
            </div>
            <div class="card-body">
                <p class="card-value">2</p>
                <p class="card-label">mod√®les disponibles</p>
            </div>
        </div>

        <div class="card card-info">
            <div class="card-header">
                <h3 class="card-title">üì• Exports</h3>
            </div>
            <div class="card-body">
                <p class="card-value">CSV, XLSX, WORD, PDF</p>
                <p class="card-label">formats support√©s</p>
            </div>
        </div>

        <div class="card card-warning">
            <div class="card-header">
                <h3 class="card-title">‚ö° Status</h3>
            </div>
            <div class="card-body">
                <p class="card-value">‚úì Actif</p>
                <p class="card-label">syst√®me op√©rationnel</p>
            </div>
        </div>
    </div>

    <!-- Analyses r√©centes -->
    <div class="section">
        <h3 class="section-title">Analyses r√©centes</h3>

        {% if stats.recent_analyses %}
        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Utilisateur</th>
                        <th>Intitul√©</th>
                        <th>Mod√®le</th>
                        <th>M√©triques</th>
                    </tr>
                </thead>
                <tbody>
                    {% for analysis in stats.recent_analyses %}
                    <tr>
                        <td>{{ analysis.date_analyse|format_date('%d/%m/%Y %H:%M') }}</td>
                        <td>{{ analysis.nom_utilisateur }}</td>
                        <td>{{ analysis.intitule }}</td>
                        <td><span class="badge">S{{ analysis.scenario_id }}</span></td>
                        <td>
                            {% if analysis.metriques %}
                                {{ analysis.metriques.total_actes|format_number }} actes -
                                {{ analysis.metriques.montant_total|format_currency }}
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>Aucune analyse r√©cente</p>
            <a href="{{ url_for('main.scenarios_list') }}" class="btn btn-primary">Commencer une analyse</a>
        </div>
        {% endif %}
    </div>

    <!-- Raccourcis -->
    <div class="section">
        <h3 class="section-title">Raccourcis</h3>
        <div class="cards-grid">
            <a href="{{ url_for('scenario1.form') }}" class="card card-link">
                <div class="card-body">
                    <h4>üîç Mod√®le 1</h4>
                    <p>Analyse actes ex√©cut√©s (Nombre et Montant total)</p>
                </div>
            </a>

            <a href="{{ url_for('main.scenarios_list') }}" class="card card-link">
                <div class="card-body">
                    <h4>üìã Tous les mod√®les</h4>
                    <p>Voir la liste compl√®te des mod√®les d'analyse disponibles</p>
                </div>
            </a>
        </div>
    </div>
</div>
{% endblock %}
